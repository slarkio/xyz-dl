# 🎧 xyz-dl - 小宇宙播客下载器

> ✨ 轻松下载小宇宙播客音频和文字内容，让你的播客收藏更自由！

## 🌟 为什么选择 xyz-dl？

🎵 **超简单使用** - 只需一个命令，音频和文字全搞定
📱 **两种输入方式** - 支持完整链接或简洁的ID，怎么方便怎么来
🎯 **智能文件命名** - 自动解析主播和节目信息，文件井井有条
🚀 **异步下载** - 快速稳定，还有美美的进度条
📝 **Show Notes 支持** - 不只是音频，播客的文字内容也能保存
🎨 **颜值很高** - 现代化界面，用起来心情都变好了
🔒 **安全可靠** - 内置安全防护，文件下载更安全放心
⚡ **更快更稳** - 智能缓存和优化，下载速度更快更稳定
🔄 **自动恢复** - 网络中断自动重试，大文件支持断点续传
📊 **进度保存** - 下载进度实时保存，意外中断可恢复  

## 🛠️ 安装

```bash
# 1. 克隆项目到本地
git clone https://github.com/slarkio/xyz-dl.git
cd xyz-dl

# 2. 一键安装所有依赖（会自动创建 xyz-dl 命令）
uv sync
```

*需要 Python 3.8+ 环境，如果没有 uv 的话先安装一下：`pip install uv`*

## 🚀 开始使用

### 最简单的用法
```bash
# 使用 episode ID（推荐，超简洁！）
uv run xyz-dl 12345678

# 使用完整链接
uv run xyz-dl https://www.xiaoyuzhoufm.com/episode/12345678
```

### 更多玩法

```bash
# 🎵 只下载音频
uv run xyz-dl --mode audio 12345678

# 📝 只下载文字内容
uv run xyz-dl --mode md 12345678

# 📁 指定下载文件夹
uv run xyz-dl -d ~/我的播客收藏 12345678

# 🔗 只获取下载链接，不实际下载
uv run xyz-dl --url-only 12345678

# 🔧 自定义配置（网络不好时特别有用）
uv run xyz-dl --timeout 60 --max-retries 5 12345678

# 👀 想看详细下载过程
uv run xyz-dl -v 12345678
```

## 📋 参数说明

| 参数 | 说明 | 默认值 |
|------|------|--------|
| `url` | 播客链接或 episode ID | 必填 |
| `-d, --dir` | 下载到哪个文件夹 | 当前文件夹 |
| `--mode` | 下载什么：`audio`(音频) / `md`(文字) / `both`(都要) | `both` |
| `-u, --url-only` | 仅获取下载链接，不实际下载 | 关闭 |
| `--timeout` | 网络超时时间（秒） | 30 |
| `--max-retries` | 网络不好时重试几次 | 3 |
| `--user-agent` | 自定义用户代理（高级用法） | 浏览器标准 |
| `-v, --verbose` | 显示详细信息 | 关闭 |

## 💡 为什么这么稳定？

xyz-dl 在背后做了很多优化，让你的下载体验更好：

✅ **智能重试** - 网络不稳定？自动重试，不用担心下载失败
✅ **断点续传** - 大文件下载中断了？接着之前的进度继续下载
✅ **内容安全** - 自动处理文件名和内容，避免各种兼容性问题
✅ **内存友好** - 大文件也不会吃光你的内存

## 💡 怎么获取 episode ID？

超简单！在小宇宙 App 中：

1. 📱 打开想下载的播客节目
2. 👆 点击「分享」按钮  
3. 📋 复制链接：`https://www.xiaoyuzhoufm.com/episode/12345678`
4. ✂️ 取最后的数字部分：`12345678`

或者直接用完整链接也可以，xyz-dl 都认识！

## 📂 文件会保存成什么样？

xyz-dl 会智能解析播客信息，生成规整的文件名：

```
12345678_张三 - 科技闲聊第42期.mp3
12345678_张三 - 科技闲聊第42期.md
```

格式：`[Episode ID]_[主播名] - [节目名].[扩展名]`

🧹 **自动清理**：文件名中的特殊字符会被自动处理，确保在各种系统上都能正常保存

### 📝 Markdown 文件元数据说明

下载的 `.md` 文件使用 YAML Front Matter 格式保存完整的播客元信息，包含以下字段：

**📋 基础信息**
- `title`: 节目标题
- `podcast_name`: 播客名称  
- `duration_text`: 播放时长

**🔗 链接信息**
- `url`: 节目链接
- `podcast_url`: 播客主页链接
- `audio_url`: 音频文件地址

**🕒 时间信息**  
- `published_at`: 发布时间（UTC格式）
- `published_date`: 发布日期（本地格式）
- `published_datetime`: 发布时间（可读格式）

**🆔 标识信息**
- `episode_id`: 节目唯一ID
- `podcast_id`: 播客唯一ID

**📊 下载记录**
- `downloaded_by`: 下载工具标识
- `downloaded_at`: 下载时间戳

这种标准化的元数据格式便于后续数据处理和搜索，支持所有兼容 YAML Front Matter 的工具使用。

## ⚙️ 高级配置

如果你是重度用户，可以设置环境变量来自定义默认行为：

```bash
# 设置默认超时时间
export XYZ_DL_TIMEOUT=60

# 设置默认重试次数
export XYZ_DL_MAX_RETRIES=5

# 自定义用户代理
export XYZ_DL_USER_AGENT="我的播客下载器"
```

## 🆘 遇到问题？

**网络问题**：试试增加超时时间和重试次数
**下载失败**：检查链接是否正确，或者换个网络环境
**文件找不到**：确认下载目录是否有写入权限
**下载很慢**：可能是网络问题，程序会自动优化，耐心等待即可  

## ⚠️ 使用须知

- 🏠 **仅供个人使用**：下载的内容请勿商用或二次分发
- 🤝 **尊重原创**：请支持喜欢的播客主，考虑付费订阅
- 🌐 **合理使用**：不要频繁请求，给服务器一些喘息空间
- 📖 **遵守条款**：使用时请遵守小宇宙平台的使用协议

## 💝 致谢

感谢小宇宙提供优质的播客平台，感谢所有创作优质内容的播客主们！

---

*Made with ❤️ for podcast lovers*